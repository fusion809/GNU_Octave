function zer = DEP(params, x, dx, t)
    m1     = params.m1;
    m2     = params.m2;
    g      = params.g;
    l1     = params.l1;
    l2     = params.l2;
    k1     = params.k1;
    k2     = params.k2;
    b1     = params.b1;
    b2     = params.b2;
    c1     = params.c1;
    c2     = params.c2;
    zer    = zeros(8,1);
    r1     = x(1);
    dr1    = x(2);
    r2     = x(3);
    dr2    = x(4);
    th1    = x(5);
    dth1   = x(6);
    th2    = x(7);
    dth2   = x(8); 
    dx(1)  = dr1;
    dx(3)  = dr2;
    dx(5)  = dth1;
    dx(7)  = dth2;
    d2r1   = dx(2);
    d2r2   = dx(4);
    d2th1  = dx(6);
    d2th2  = dx(8);
    del    = th2-th1;
    ddel   = dth2 - dth1;
    ddel1  = 2*dth1 - dth2;
    ddel2  = 2*dth2 - dth1;
    v1  = sqrt(dr1^2+r1^2*dth1^2);
    v2  = sqrt(v1^2 + dr2^2 + r2^2*dth2^2 + 2*cos(del)*(dr1*dr2 + r1*r2*dth1*dth2)+2*sin(del)*(r1*dr2*dth1-dr1*r2*dth2));
    Qr1 = -(b1 + c1*v1)*dr1 - (b2 + c2*v2)*(dr1 + dr2*cos(del)-r2*dth2*sin(del));
    Qr2 = -(b2 + c2*v2)*(dr1*cos(del) + r1*dth1*sin(del)+dr2);
    Qt1 = -(b1 + c1*v1)*r1^2*dth1 - (b2 + c2*v2)*(r1^2*dth1 + r1*dr2*sin(del) + r1*r2*dth2*cos(del))
    Qt2 = -(b2 + c2*v2)*(r2^2*dth2 - dr1*r2*sin(del) + r1*r2*dth1*cos(del))
    zer(1) = d2r1 - r1*dth1^2 + g*sin(th1) - m2/(m1+m2)*(cos(del)*(r2*dth2^2-d2r2)+sin(del)*(2*dr2*dth2+r2*d2th2)) + (k1*(r1-l1)-Qr1)/(m1+m2);
    zer(2) = d2r2 + cos(del)*(d2r1 - r1*dth1^2) + sin(del)*(r1*d2th1 + dr1*dth1) - r2*dth2^2 + g*sin(th2) + (k2*(r2-l2)-Qr2)/m2;
    zer(3) = d2th1 + 2*dr1*dth1/r1 + g*cos(th1)/r1 + m2/((m1+m2)*r1)*(cos(del)*(2*dr2*dth2 + r2*d2th2)+sin(del)*(d2r2-r2*dth2^2)) - Qth1/((m1+m2)*r1^2);
    zer(4) = d2th2 + 2*dr2*dth2/r2 + g*cos(th2)/r2 + cos(del)/r2*(2*dr1*dth1+r1*d2th1) + sin(del)/r2*(r1*dth1^2-d2r1) - Qth2/(m2*r2^2);
endfunction